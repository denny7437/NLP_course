# Religious Hate Speech Detection: Rule-Based vs BERT Comparison

![Python](https://img.shields.io/badge/python-v3.10+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.1.0-red.svg)
![Transformers](https://img.shields.io/badge/ü§ó%20Transformers-4.44.0-yellow.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è —á—É–≤—Å—Ç–≤ –≤–µ—Ä—É—é—â–∏—Ö –≤ —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω—ã—Ö —Ç–µ–∫—Å—Ç–∞—Ö. –ü—Ä–æ–µ–∫—Ç —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å rule-based –ø–æ–¥—Ö–æ–¥–æ–≤ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö BERT-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤ –≤ —É—Å–ª–æ–≤–∏—è—Ö domain shift.

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–æ–¥–µ–ª—å | –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö | –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö | –í—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ |
|--------|--------------------------------|---------------------------|-----------------|
| **Rule-based** | 100.0% | **100.0%** | **0.001 —Å–µ–∫** |
| **BERT v1** | 57.5% | 57.5% | 1.2 —Å–µ–∫ |
| **BERT v2 (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)** | 99.0% | 65.6% | 1.5 —Å–µ–∫ |
| **BERT v3 (—É–ª—É—á—à–µ–Ω–Ω–∞—è)** | **98.6%** | 70.6% | 1.9 —Å–µ–∫ |

**–í—ã–≤–æ–¥**: Rule-based –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑–∞–ª–∞ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–æ –≤ —É—Å–ª–æ–≤–∏—è—Ö domain shift, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—è –∏–¥–µ–∞–ª—å–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç–∞—Ö.

## üìä –î–∞–Ω–Ω—ã–µ

- **–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç**: 1,800 –ø—Ä–∏–º–µ—Ä–æ–≤ (`train - –õ–∏—Å—Ç1.csv`)
  - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç: 830 (46.1%)
  - –û–ø–∞—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç: 970 (53.9%)
- **–¢–µ—Å—Ç–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç**: 160 –ø—Ä–∏–º–µ—Ä–æ–≤ (`eval_modernbert - –õ–∏—Å—Ç1.csv`)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–µ–∫—Å–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install torch transformers scikit-learn pandas numpy
```

### –ó–∞–ø—É—Å–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π

```bash
python compare_bert_vs_rules.py
```

### –û–±—É—á–µ–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω–æ–π BERT –º–æ–¥–µ–ª–∏

```bash
python train_bert_detector.py
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ train - –õ–∏—Å—Ç1.csv                    # –¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ eval_modernbert - –õ–∏—Å—Ç1.csv          # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ optimized_religious_classifier/      # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è BERT –º–æ–¥–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ bert_religious_classifier_improved/  # –£–ª—É—á—à–µ–Ω–Ω–∞—è BERT –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ compare_bert_vs_rules.py            # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ train_bert_detector.py              # –û–±—É—á–µ–Ω–∏–µ BERT
‚îÇ   ‚îú‚îÄ‚îÄ train_final_model.py                # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ label_test_data.py                  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ research_analysis.md                # –ù–∞—É—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îî‚îÄ‚îÄ main.tex                           # LaTeX —Å—Ç–∞—Ç—å—è
‚îî‚îÄ‚îÄ README.md
```

## üî¨ –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

### Rule-Based –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä

–õ–µ–∫—Å–∏–∫–æ-—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ 350+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:

```python
f_rule(x) = {
    1, –µ—Å–ª–∏ ‚àÉœâ ‚àà Œ©_dangerous : œâ ‚äÜ x
    0, –∏–Ω–∞—á–µ
}
```

**–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–ø–∞—Å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:**
- –ü—Ä—è–º—ã–µ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è: `{–¥—É—Ä–∞–∫–∏, –∏–¥–∏–æ—Ç—ã, —Ñ–∞–Ω–∞—Ç–∏–∫–∏, ...}`
- –ü—Ä–∏–∑—ã–≤—ã –∫ –Ω–∞—Å–∏–ª–∏—é: `{—É–Ω–∏—á—Ç–æ–∂–∏—Ç—å, —Å–∂–µ—á—å, —É–±–∏—Ç—å, ...}`
- –°–µ–∫—Ç–∞–Ω—Ç—Å–∫–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è: `{—Å–µ–∫—Ç–∞, –ø—Ä–æ–º—ã–≤–∞–Ω–∏–µ –º–æ–∑–≥–æ–≤, ...}`

### BERT –ú–æ–¥–µ–ª–∏

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- –ú–æ–¥–µ–ª—å: `DeepPavlov/rubert-base-cased` (180M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
- GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ: NVIDIA A100 80GB
- –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Cosine learning rate scheduler
- Mixed precision training (FP16)

## üìà –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

### –ü—Ä–æ–±–ª–µ–º–∞ Domain Shift

–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
```
P_train(X) ‚â† P_test(X)
```

**–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**
- **–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**: –Ø–≤–Ω—ã–µ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è, –ø—Ä–∏–∑—ã–≤—ã –∫ –Ω–∞—Å–∏–ª–∏—é
- **–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ**: –†–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–∏—Ç—á–∏, –∂–∏—Ç–∏–π–Ω—ã–µ —Ä–∞—Å—Å–∫–∞–∑—ã

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

BERT –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑–∞–ª–∞ –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (98.6%), –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö (70.6%) –∏–∑-–∑–∞ domain shift, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ rule-based –ø–æ–¥—Ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω–∏–ª –∏–¥–µ–∞–ª—å–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

## üèÜ –ù–∞—É—á–Ω—ã–µ –≤—ã–≤–æ–¥—ã

1. **–¢–µ–æ—Ä–µ–º–∞ –æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–µ rule-based –ø–æ–¥—Ö–æ–¥–∞**: –í —É—Å–ª–æ–≤–∏—è—Ö —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ª–µ–∫—Å–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ domain shift, rule-based –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–≥–æ–µ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –ü–∞—Ä–µ—Ç–æ.

2. **–ì–∏–ø–æ—Ç–µ–∑–∞ –æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–∏**: –í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å BERT –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –Ω–∏–∑–∫–æ–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É–µ—Ç –æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–∏ –∫ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º.

3. **–ü—Ä–∏–Ω—Ü–∏–ø –û–∫–∫–∞–º–∞**: –ü—Ä–æ—Å—Ç–µ–π—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ –æ–∫–∞–∑–∞–ª–æ—Å—å –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞**: Rule-based –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–±—ã—Å—Ç—Ä—ã–π, —Ç–æ—á–Ω—ã–π, –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π)
- **–î–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π**: BERT –º–æ–¥–µ–ª–∏ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥**: Rule-based –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ + BERT –¥–ª—è –ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤

## üìö –ü—É–±–ª–∏–∫–∞—Ü–∏–∏

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω—ã –≤ –≤–∏–¥–µ –Ω–∞—É—á–Ω–æ–π —Å—Ç–∞—Ç—å–∏:
- **LaTeX**: `docs/main.tex`
- **–ê–Ω–∞–ª–∏–∑**: `docs/research_analysis.md`

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

**–°—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
- Python 3.10
- PyTorch 2.1.0
- Transformers 4.44.0
- NVIDIA A100 80GB GPU

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤–µ—Ä—Å–∏–π TensorFlow/PyTorch
- –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–µ–∫—Å–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª LICENSE –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

**–î–µ–Ω–∏—Å** - [denny7437](https://github.com/denny7437)

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- DeepPavlov –∑–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é RuBERT –º–æ–¥–µ–ª—å
- Hugging Face –∑–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫—É Transformers
- –°–æ–æ–±—â–µ—Å—Ç–≤–æ open-source –∑–∞ –±–∞–∑–æ–≤—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

*–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ NLP —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–æ–≤.* 